CREATE TABLE IF NOT EXISTS ZONES (
	ID				SERIAL NOT NULL PRIMARY KEY,
	NAME			VARCHAR(255) NOT NULL,
	DESCRIPTION 	TEXT,
	CREATED_AT 		TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE ROLE_ENUM AS ENUM (
	'ROLE_CLIENT',
	'ROLE_SALESMAN'
);

CREATE TABLE IF NOT EXISTS USERS (
	ID				SERIAL NOT NULL PRIMARY KEY,
	NAME			VARCHAR(255) NOT NULL,
	AGE				INT DEFAULT 0,
	ROLE			ROLE_ENUM DEFAULT 'ROLE_CLIENT',
	CREATED_AT		TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS BOOKS (
	ID				SERIAL NOT NULL PRIMARY KEY,
	NAME 			VARCHAR(255) NOT NULL,
	DESCRIPTION 	TEXT,
	ISBN 			VARCHAR(15),
	STOCK 			INT DEFAULT 0,
	FK_ZONE 		SERIAL NOT NULL REFERENCES ZONES(ID) ON DELETE CASCADE,
	PUBLISHED_AT	DATE DEFAULT CURRENT_DATE,
	CREATED_AT		TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS SALES (
	ID 			SERIAL NOT NULL PRIMARY KEY,
	FK_SALESMAN SERIAL REFERENCES USERS(ID),
	FK_CLIENT 	SERIAL REFERENCES USERS(ID),
	TOTAL 		FLOAT DEFAULT 0,
	CREATED_AT	TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS SALES_BOOKS (
	FK_SALE SERIAL REFERENCES SALES(ID),
	FK_BOOK SERIAL REFERENCES BOOKS(ID)
);